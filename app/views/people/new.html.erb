<h1>New person</h1>

<% form_for(@person) do |f| %>
  <%= f.error_messages %>

  <p>
    <%= f.label :state_id %><br/>
    <%= f.collection_select :state_id, @states, :id, :name, { :include_blank => true }, { :onchange => remote_function(:url => { :action => 'state_changed' }, :with => "'state_id='+$('state').value") } %>
  </p>
  <div id="counties">
    <%= render :partial => 'counties', :locals => { :f => f, :counties => @counties } %>
  </div>
  <p>
    <%= f.label :name %><br />
    <%= f.text_field :name %>
  </p>
  <p>
    <%= f.label :age %><br />
    <%= f.text_field :age %>
  </p>

  <p>
    <%= f.submit 'Create' %>
  </p>
<% end %>

<%= link_to 'Back', people_path %>
